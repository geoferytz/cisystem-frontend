<div class="flex items-center">
  <h2 class="text-xl font-semibold text-slate-900">Expiry & Alerts</h2>
</div>

<div class="mt-4 rounded-2xl bg-white p-4 shadow-sm ring-1 ring-slate-100">
  <form class="grid gap-3 sm:grid-cols-[200px_200px_auto] sm:items-end" [formGroup]="form" (ngSubmit)="load()">
    <label class="grid gap-2 text-xs text-slate-700">
      Expiry alert days
      <input class="rounded-xl border border-slate-200 px-3 py-2 text-sm" type="number" formControlName="days" />
    </label>

    <label class="grid gap-2 text-xs text-slate-700">
      Low stock threshold
      <input class="rounded-xl border border-slate-200 px-3 py-2 text-sm" type="number" formControlName="threshold" />
    </label>

    <button class="rounded-xl bg-indigo-950 px-4 py-2 text-sm font-semibold text-white" type="submit">Apply</button>
  </form>

  <div class="mt-3 text-sm text-red-700" *ngIf="error()">{{ error() }}</div>

  <div class="mt-6 grid grid-cols-1 gap-4 xl:grid-cols-2">
    <section>
      <h3 class="text-base font-semibold text-slate-900">Expiring / Expired Stock</h3>
      <div class="mt-2 overflow-auto rounded-xl ring-1 ring-slate-100">
        <table class="w-full border-collapse text-sm">
          <thead class="bg-slate-50">
            <tr>
              <th class="px-3 py-2 text-left text-xs font-semibold text-slate-600">SKU</th>
              <th class="px-3 py-2 text-left text-xs font-semibold text-slate-600">Product</th>
              <th class="px-3 py-2 text-left text-xs font-semibold text-slate-600">Batch</th>
              <th class="px-3 py-2 text-left text-xs font-semibold text-slate-600">Expiry</th>
              <th class="px-3 py-2 text-right text-xs font-semibold text-slate-600">Qty</th>
              <th class="px-3 py-2 text-right text-xs font-semibold text-slate-600">Days</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let a of expiry()" class="border-t border-slate-100">
              <td class="px-3 py-2">{{ a.sku }}</td>
              <td class="px-3 py-2">{{ a.productName }}</td>
              <td class="px-3 py-2">{{ a.batchNumber }}</td>
              <td class="px-3 py-2">{{ a.expiryDate }}</td>
              <td class="px-3 py-2 text-right font-semibold">{{ a.qtyOnHand }}</td>
              <td class="px-3 py-2 text-right" [class.text-red-700]="a.daysToExpiry < 0">{{ a.daysToExpiry }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <section>
      <h3 class="text-base font-semibold text-slate-900">Low Stock</h3>
      <div class="mt-2 overflow-auto rounded-xl ring-1 ring-slate-100">
        <table class="w-full border-collapse text-sm">
          <thead class="bg-slate-50">
            <tr>
              <th class="px-3 py-2 text-left text-xs font-semibold text-slate-600">SKU</th>
              <th class="px-3 py-2 text-left text-xs font-semibold text-slate-600">Product</th>
              <th class="px-3 py-2 text-right text-xs font-semibold text-slate-600">Qty</th>
              <th class="px-3 py-2 text-right text-xs font-semibold text-slate-600">Threshold</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let a of lowStock()" class="border-t border-slate-100">
              <td class="px-3 py-2">{{ a.sku }}</td>
              <td class="px-3 py-2">{{ a.productName }}</td>
              <td class="px-3 py-2 text-right font-semibold">{{ a.qtyOnHand }}</td>
              <td class="px-3 py-2 text-right">{{ a.threshold }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
  </div>
</div>
